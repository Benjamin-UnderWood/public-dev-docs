# 后端服务的开发基本流程

定开发后端服务的基本原则是为了能够更规范的开发我们的服务，也能适当减少沟通带来的成本。

## API类型的服务

API类型的服务需要对外提供API，当前主要以REST 风格的API为主，后期可能会有其他类型的API（GRPC），此类型的服务的基本开发流程：

1. 定义API：定义需要对外输出的API，定义完成之后，对外输出swagger文档，同时需要相关人员进行review：主要review：API形式，model
2. 定义存储的数据结构：如果服务需要持久化数据，那么需要在这一步定义清楚需要持久化的数据结构，并明确表明每个字段的含义。主要review点：因我们大部分数据是来源于第三方，所以需要保证数据源的数据被合理的融合进了我们的数据
3. 设计业务逻辑：关键、复杂的业务处理，需要有设计相关文档，可以简单的画出业务执行流程，以及步骤定义。主要review点：逻辑是否可精简（保留核心流程，其他流程走异步之类的）
4. 代码实现：根据设计实现业务逻辑代码。这个部分不需要太多思考，按照设计去实现即可。主要review点：可以设计与实现是否合适
5. 测试用例：这个不要求代码覆盖率以及分支覆盖率，但是要求核心逻辑必须测全

## 独立运行的服务

 独立运行的服务，如定时任务、消息处理任务等，次类任务，不需要对外提供API，但是可能需要持久化数据、或者对外发布消息等。与上面的服务类型相比，除了第一步不需要之外，其他的都需要

## 代码分支定义与使用

1. 如果服务是一个全新的服务，那么可以再第一版的开发中直接使用master分支
2. 服务一旦上线，需要保证master分支能够随时部署到线上去。也就是需要维持下面几个约定：
    1. 每次新版本上线，打个TAG
    2. 线上的bugfix，开个bugfix的分支，修复、测试完毕之后，merge到master，并上线
    3. 新功能开发，以功能名命名一个分支，并在新分支上进行开发，测试完毕之后合并到master，进行上线
    4. 版本回退，如果线上版本出了问题，需要回退，先保留master分支，然后将master分支回退到固定版本
