# 任何写日志

如同错误处理代码，日志也是程序的重要组成部分。尤其是分布式并行程序，很多时候日志是唯一有效的调试方法。传统的日志偏重运行时的错误调试，现在的日志增加了运维的功能。一个典型的程序包括三分之一正常业务处理逻辑，三分之一异常业务处理，还有三分之一是 log 代码，在不同层次记录系统的运行路径和关键运维/调试数据。

## 日志的基本原则

- 日志的用户是系统运维人员和程序员，和业务人员无关。
- 日志有五个级别：Error， Warning， Info， Debug， Trace。
- 正常状态的日志级别是 Info，其用户是系统运维人员。用于发现错误和性能问题。
- 开发人员用 Debug 和 Trace 级别来定位错误。
- 日志是运维和查错的重要工具，要和业务代码一样认真对待。
- 记录完整的执行路径和相关业务信息。不要有重复信息。
- 通常一个函数只需要一个进入或退出时的信息。调用函数也不重复被调用函数的日志信息。
- 任何错误/异常发生的地方都要用日志记录。
- 仔细规划日志的级别，如果下面的通用指南不够清醒，请在业务模块给出清醒的日志级别指南。

## 日志级别的使用指南

Error 表示严重错误，应用程序无法执行。比如运行错误、不能连接到数据库、调用参数错误或严重业务数据错误。Error 级别的错误属于高优先级 bug，需要开发人员立即修复。

Warning 表示不影响程序继续运行的各种系统错误，比如网络超时。运维人员需要每天留意 Warning 信息，看看是否有异常情况。

Info 表示一个重要的系统事件。可以给系统运维人员提供重要的系统运行状态。Info 事件的频率应该在分钟级，即一分钟不超过一条。常见的 Info 事件有：

- 系统的生命周期：启动、初始化、停止等。
- 重要的业务事件：比如登录、登出、创建新用户、密码重置、登录错误。
- 重要的跨业务模块（跨进程）的请求的开始和结束：REST/RPC API 的调用。用于监控系统性能。

Debug 是调试的主要级别。这个级别的信息应该给出完整的执行路径和重要的执行结果。打印的信息不应该太详细（比如有十个以上的属性），也不应该用在重复十次以上的循环内部。

Trace 给出详细的程序运行状态。Trace 可以用在循环的内部或用于打印完整的详细信息。当输出详细信息是，通常也先有一个 Debug 级别的摘要信息。比如，Debug 信息给出数组的尺寸，而 Trace 级别给出具体的数组数据（所有元素或一部分元素）。

## 日志例子
